# Домашнее задание №17
Скрипт деплоя

## Цель
Познакомиться с понятиями деплоя и сборок. Научиться доставлять приложение до указанной среды.

## Задача
Используя выбранный инструмент автоматического деплоя, необходимо реализовать автоматическую выкатку написанного ранее мини-приложения на собственный виртуальный сервер. 

## Критерии оценки
1. автоматическая доставка на любую среду,
1. доставка без downtime,
1. желательно организовать отдельный закрытый репозиторий настроек, из которого формируются файлы конфигурации для выбранной среды в момент деплоя.

## Краткое описание приложения
Приложение получает целое число и средствами базы данных генерирует случайные строки в таблице БД.

## API
Эндпоинт|Метод|Описание
---|---|---
http://localhost/|GET|Используется для пинга
http://localhost/init|GET|Инициализация БД
http://localhost/list|GET|Выводит список из 10 записей (используется в служебных целях для проверки обновления данных)
http://localhost/add/<количество_строк>|POST|Синхронный метод добавления случайных строк в БД

## Описание деплоя
Для деплоя используется _capistrano_. Реализован следующий сценарий разворачивания приложения:
1. доставка изменений кода из _github_ репозитория,
1. обновление пакетов через _composer_,
1. запуск мигратора базы данных.

Приложение деплоится на VDS. Реализована конфигурация для одной среды _production_. При каждом релизе в качестве миграций используется следующий скрипт: предварительная очистка от старых записей и добавление двух записей в БД со случайными данными.

## Как проверить выполненное задание
1. запустить все службы `docker-compose up -d`,
1. войти в контейнер _capistrano_, для этого выполнить `docker exec -it capistrano bash`,
1. запустить деплой командой `cap production deploy`.