# Тесты

## Модульные тесты

#### бэк

- Передаем валидные данные для которых мок сервиса А возвращает true и мок репозитория возвращает true - тестируемый метод возвращает 200
- Передаем валидные данные для которых мок сервиса А возвращает false - тестируемый метод возвращает 403
- Передаем валидные данные для которых мок сервиса А возвращает true и мок репозитория возвращает false - тестируемый метод возвращает 403 (поведение для такой ситуцаии не описано, но предположим что в таком случае мы не проводим платеж, отменяем транзакцию в платежной системе и возвращаем 403)
- Передаем валидные данные для которых мок сервиса А возвращает true и мок репозитория выбрасывает исключение - тестируемый метод возвращает 403
- Данные отсутствуют - тестируемый метод возвращает 400 с сообщением об ошибке
- Данные невалидны (невалидный json) - метод возвращает 400 с сообщением об ошибке
- Данные не содержат card_number/card_holder/card_expiration/cvv/order_number/sum - метод возвращает 400 с сообщением об ошибке
- card_number/card_holder/card_expiration/cvv/order_number/sum - не строка - метод возвращает 400 с сообщением об ошибке
- card_number/card_holder/card_expiration/cvv/order_number/sum - пустая строка - метод возвращает 400 с сообщением об ошибке
- card_number/card_holder/card_expiration/cvv/order_number/sum - длина строки больше максимально возможной для этого поля - метод возвращает 400 с сообщением об ошибке
- card_number содержит букву/пробел/точку - метод возвращает 400 с сообщением об ошибке
- card_holder содержит нелатинскую букву - метод возвращает 400 с сообщением об ошибке
- card_expiration не содержит '/', содержит букву/пробел/точку, месяц - 00/13, card_expiration меньше текущей даты - метод возвращает 400 с сообщением об ошибке
- card_expiration - равен текущей дате - метод возвращает ожидаемый ответ (уточнить)
- cvv содержит букву/пробел/точку - метод возвращает 400 с сообщением об ошибке
- sum содержит букву/пробел/минус/плюс, значения - ',1'/'1,'/'1,1,1'/'0', значение больше максимально допустимого, количество знаков после запятой больше максимально допустимого - метод возвращает 400 с сообщением об ошибке
- sum - максимально допустимое значение - метод вернет 200

## Интеграционные тесты

#### бэк - фронт

Репозиторий мокаем - всегда возвращает true.

- Вводим на фронте валидные данные, для которых мок сервиса А возвращает true, отправляем их на бэк - проверяем что вернулось 200 и на фронте ответ корректно обработался
- Вводим на фронте валидные данные, для которых мок сервиса А возвращает false, отправляем их на бэк - проверяем что вернулось 403 и на фронте есть сообщение об ошибке
- Вводим на фронте невалидные данные, отправляем их на бэк - проверяем что вернулось 400 и на фронте есть сообщение об ошибке

#### бэк - репозиторий

Сервис А мокаем - всегда возвращает true.

- Передаем в бэк данные для которых репозиторий должен вернуть true - метод возвращает 200, в БД есть информация об успешной оплате
- Передаем в бэк данные для которых репозиторий должен вернуть false - метод возвращает 403, в БД нет информация об оплате

#### бэк - сервис А

Репозиторий мокаем - всегда возвращает true.

- Передаем в бэк данные для которых сервис А должен вернуть true - тестируемый метод возвращает 200, в сервисе А заказ оплачен
- Передаем в бэк данные для которых сервис А должен вернуть false - тестируемый метод возвращает 403, в сервисе А заказ не оплачен

##  Системные тесты

- Вводим на фронте валидные данные, отправляем их на бэк - проверяем что на фронте ответ корректно обработался
- Вводим на фронте невалидные данные, отправляем их на бэк - проверяем что на фронте есть сообщение об ошибке

## Примечание

В интеграционных и системных тестах для сервиса А должен использоваться отдельный тестовый аккаунт. Ну или на крайний случай боевой аккаунт (желательно отдельный), но со списанием минимально возможной суммы с последующей отменой платежей.